<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>달력</title>
</head>
<body>
    <!-- 달력 HTML 구조 -->
    <div id="container">
        <div id="date-wrap">
            <!-- 이전 -->
            <button type="button" id="before01" onclick="before01()">이전</button>
            <!-- 현재 -->
            <div id="mainDate"></div>
            <!-- 이후 -->
            <button type="button" id="after01 "onclick="after01()">이후</button>
        </div>
        <table id="date-week">
            <thead>
                <th>SUN</th>
                <th>MON</th>
                <th>TUE</th>
                <th>WED</th>
                <th>THU</th>
                <th>FRI</th>
                <th>SAT</th>
            </thead>
        </table>
        <!-- 달력 날짜 값 입력 -->
        <div id="displayTable"></div>
    </div>

    <!-- 스크립트 -->
    <script>
        // document 변수 만들기
        // 전역 변수 : 전지역에서 사용 가능한 변수
        let yearMonth = document.getElementById('mainDate');
        let displayTable =document.querySelector("#displayTable");
        let today=new Date(); // 오늘 날짜/시간

        // 2차원배열 지정
        let arr=Array.from(Array(6),()=>new Array(7));

        // 달력의 배열에 값을 저장하는 함수 // ----------calender... ????????????????????????
        function calender(){ 
            // 1. 올해 년도 출력하는 변수
            let year=today.getFullYear(); // 2025  

            // 2. 오늘 날짜의 월을 출력하는 변수
            let month=today.getMonth(); // 9

            // 3. 이달의 마지막 일자 구하기
            //    일의 0을 지정하면 그 전달의 마지막 일자를 출력한다.
            // new Date(2025,4+1(5월),0) => 2025-4-30
            let lastDate=new Date(year,month+1,0); // month는 8로 나오기 때문에 +1을 해줘야함
            // 마지막 일자만 출력하는 변수
            let lastDay=lastDate.getDate();
            
            // 4. 이달의 1일이 무슨 요일인지 구하기
            //    getDay() : 0(일요일) ~ 6(토요일)
            //    1월 : 0 ~ 12월 : 11
            let startDate=new Date(year,month+1,1);
            // 월의 시작요일만 출력하는 변수
            let startDay=startDate.getDay(); // 1(월요일)
            // 월의 시작일만 출력하는 변수
            let startWeek=startDate.getDay(); // 1

            // 가로 시작 ---------------????
            let row=0;

            // 배열 초기화
            // 배열초기화를 안하면 undefind가 출력되기 때문에 반드시 초기화해야함
            for(let i=0;i<arr.length;i++){
                for(let j=0;j<arr[i].length;j++){
                    arr[i][j]='';
                }
            }
            // 핵심코드
            // 달력 배열의 실제 날짜를 채우는 핵심 로직
            // i=시작일 1, i<=마지막일자 30까지 루프 돌리기
            for(let i=startDay; i<=lastDay;i++){
                // 현재 달의 1일부터 마지막 날까지 반복
                // day=0, startWeek=1 => arr[0][1] 
                arr[row][startWeek]=i; // -----------------------???

                // 7일이되면 줄바꿈 코드
                if(startWeek<arr[row].length-1){
                    // 만약에 현재요일이 6(토요일)이 아니면
                    startWeek++;
                }else{
                    // 현재 요일이 토요일이면 한 주가 끝난 것
                    // 다음행으로 이동
                    row++; // ----------------- 이게 누적?
                    // startWeek를 0으로 리셋
                    startWeek=0;
                }
            }

        }


        // display 출력하는 함수----------------???
        // display()호출하여 화면 출력
        function display(){
            // 반드시 해야하는 작업
            calender(); // 달력 호출
                let tb ="<table class='cal_table'>";
                //가로줄
                for(let i=0;i<arr.length;i++){
                    tb +="<tr>";
                    // 세로줄
                    for(let j=0;j<arr[i].length;j++){
                        tb +="<td>"+arr[i][j]+"</td>";
                    }
                    tb +="</tr>";
                }
                tb +="</table>";
                // 상단의 년월을 입력
                // yearMonth
                let yearmonth=today.getFullYear()+'년'+(today.getMonth()+1)+'월'; // 왜 소문자??
                yearMonth.innerHTML=yearmonth;
                // 배열의 달력
                console.log(yearmonth);
                displayTable.innerHTML = tb;
                console.log(tb);
        }
        
        display();
        // 이전 버튼 클릭시 날짜의 월이 -1씩 줄어들면 됨
        function before01(){
            today=new Date(today.getFullYear(),today.getMonth()-1,1); // ----------- 맨뒤에 1?
            display(); // 호출안하면 안나옴
        }
        // 이후 버튼 클릭시 날짜의 월이 +1씩 증가됨
        function after01(){
            today=new Date(today.getFullYear(),today.getMonth()+1,1); 
            display();
        }
    </script>
</body>
</html>