<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>메가박스</title>
    <link rel="styleSheet" href="megabox.css">
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
</head>
<body>
    <div class="container">
        
        <!-- header ----------------------------------------------------------- -->
        <header>
            <div class="menubar_width">
                <!-- header01 --------->
                <div class="header01">
                    <!-- header01 왼쪽 (멤버쉽, 고객센터 ....) -->
                    <ul class="header_left">
                        <li>
                            <a href="#" class="header_leftmenu">VIP LOUNGE</a>
                            <a href="#" class="header_leftmenu">멤버쉽</a>
                            <a href="#" class="header_leftmenu">고객센터</a>
                        </li>
                    </ul>
                    <!-- header01 오른쪽 (로그아웃, 빠른예매) -->
                    <ul class="header_right">
                        <li>
                            <a href="#" class="header_rightmenu">로그아웃</a>
                            <a href="#" class="header_rightmenu">빠른예매</a>
                        </li>
                    </ul>
                </div>


                <!-- header02 --------->
                <div class="header02">
                    <!-- header02 왼쪽 (리스트?,검색) -->
                    <div class="header02_left">
                        <!-- list 아이콘 -->
                        <a href="#" id="list_icon"><i class="fa-solid fa-list" ></i></a>
                        <!-- 돋보기 아이콘 -->
                        <i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                    <!-- header02 미들 (메뉴바) -->
                    <div class="header02_middle">
                        <ul class="menu">
                            <li>
                                <a href="#"><p class="menubar">영화</p></a>
                                <a href="#"><p class="menubar">예매</p></a>
                                <a href="#"><p class="menubar">극장</p></a>
                                <img src="img/logo.png">
                                <a href="#"><p class="menubar">이벤트</p></a>
                                <a href="#"><p class="menubar">스토어</p></a>
                                <a href="#"><p class="menubar">혜택</p></a>
                            </li>
                        </ul>
                        
                    </div>
                    <!-- header02 오른쪽 (일정,마이페이지) -->
                    <div class="header02_right">
                        <!-- 일정 아이콘 -->
                        <i class="fa-solid fa-calendar-days"></i>
                        <!-- 마이페이지 아이콘 -->
                        <i class="fa-regular fa-user"></i>
                    </div>
                    
                </div>
            </div>
            
            <!-- (메뉴바 마우스오버하면 보이는 파트) -->
            <ul class="header02_menu">
                <li class="menu_hidden">
                    <span >전체영화</span>
                </li>
                <li class="menu_hidden">
                    <span >빠른예매</span>
                    <span >상영시간표</span>
                    <span >더 부티크 프라이빗 예매</span>
                </li>
                <li class="menu_hidden">
                    <span >전체극장</span>
                    <span >특별관</span>
                </li>
                <li class="menu_hidden">
                    <span >진행중 이벤트</span>
                    <span >지난 이벤트</span>
                    <span >당첨자 발표</span>
                </li>
                <li class="menu_hidden">
                </li>
                <li class="menu_hidden">
                    <span >메가박스 멤버쉽</span>
                    <span >제휴/할인</span>
                </li>
            </ul>
            
            

             <!-- header03 --------->
            <div class="header03">
                <!-- 클릭시 보이는 카테고리 -->
                <div class="category">
                    <h2>SITEMAP</h2>
                    <ul class="sitemap">
                        <li>
                            <strong class="title">영화</strong>
                            <p class="content">전체영화</p>
                        </li>
                        <li>
                            <strong class="title">예매</strong>
                            <p class="content">빠른예매</p>
                            <p class="content">상영시간표</p>
                            <p class="content">더 부티크 프라이빗 예매</p>
                        </li>
                        <li>
                            <strong class="title">극장</strong>
                            <p class="content">전체극장</p>
                            <p class="content">특별관</p>
                        </li>
                        <li>
                            <strong class="title">이벤트</strong>
                            <p class="content">진행중 이벤트</p>
                            <p class="content">지난 이벤트</p>
                            <p class="content">당첨자 발표</p>
                        </li>
                        <li>
                            <strong class="title">스토어</strong>
                            <p class="content">새로운 상품</p>
                            <p class="content">메가티켓</p>
                            <p class="content">팝콘/음료/굿즈</p>
                        </li>
                        <li>
                            <strong class="title">나의 메가박스</strong>
                            <p class="content">나의 메가박스 홈</p>
                            <p class="content">예매/구매내역</p>
                            <p class="content">영화관람권</p>
                            <p class="content">스토어교환권</p>
                            <p class="content">할인/제휴쿠폰</p>
                            <p class="content">멤버쉽포인트</p>
                            <p class="content">나의 무비스토리</p>
                            <p class="content">나의 이벤트 응모내역</p>
                            <p class="content">나의 문의내역</p>
                            <p class="content">자주쓰는 할인카드</p>
                            <p class="content">회원정보</p>
                        </li>
                        <div class="secondpart">
                            <li>
                                <strong class="title">혜택</strong>
                                <p class="content">멤버쉽 안내</p>
                                <p class="content">VIP LOUNGE</p>
                                <p class="content">제휴/할인</p>
                            </li>
                            <li>
                                <strong class="title">고객센터</strong>
                                <p class="content">고객센터 홈</p>
                                <p class="content">자주묻는질문</p>
                                <p class="content">공지사항</p>
                                <p class="content">1:1문의</p>
                                <p class="content">단체/대관문의</p>
                                <p class="content">분실물문의</p>
                            </li>
                            <li>
                                <strong class="title">회사소개</strong>
                                <p class="content">메가박스소개</p>
                                <p class="content">사회공헌</p>
                                <p class="content">홍보자료</p>
                                <p class="content">제휴/부대산업문의</p>
                                <p class="content">온라인제보센터</p>
                                <p class="content">IR자료</p>
                                <p class="content">인재채용</p>
                                <p class="content">윤리경영</p>
                            </li>
                            <li>
                                <strong class="title">이용정책</strong>
                                <p class="content">이용약관</p>
                                <p class="content">위치기반서비스 이용약관</p>
                                <p class="content">개인정보처리방침</p>
                                <p class="content">스크린수배정에관한기준</p>
                            </li>
                        </div>
                        
                    </ul>
                </div>
                <div class="header03_all">
                    <ul class="header03_left">
                        <li>
                            <!-- 홈 아이콘 -->
                            <i class="fa-solid fa-house"></i>
                            <a href="#">예매</a>
                            <a href="#">빠른예매</a>
                        </li>
                    </ul>
                </div>
            </div>
                
        </header>


        <!-- main 중간 파트-------------------------------------------------- --->
        <main>
            <h2>빠른 예매</h2>
            <section>
                <div class="left">
                    <ul>
                        <li class="first_li">
                            <span id="people_num">관람인원선택</span>
                            <button type="button" id="reset_btn">초기화</button>
                        </li>
                        <li class="people_type">
                            <div class="adult">
                                <span class="type">성인</span>
                                <button class="minus">-</button>
                                <span class="p_num">0</span>
                                <button class="plus">+</button>
                            </div>
                            <div class="adult">
                                <span class="type">청소년</span>
                                <button class="minus">-</button>
                                <span class="p_num">0</span>
                                <button class="plus">+</button>
                            </div>
                            <div class="adult">
                                <span class="type">경로</span>
                                <button class="minus">-</button>
                                <span class="p_num">0</span>
                                <button class="plus">+</button>
                            </div>
                            <div class="adult">
                                <span class="type">우대</span>
                                <button class="minus">-</button>
                                <span class="p_num">0</span>
                                <button class="plus">+</button>
                            </div>
                        </li>
                    </ul>
                     <!-- 좌석 테이블 -->
                    <div class="table_container">
                        <div class="screen"><h3>SCREEN</h3></div>
                        <div class="seat_table"></div>
                    </div>
                </div>

                <!-- 오른쪽 파트 -->
                <div class="right">
                    <!-- 영화 제목-->
                    <div class="movie_title">
                        <ul>
                            <li><span id="age">15 </span><span id="title">어쩔수가없다</span></li>
                            <li><span class="blur">2D</span></li>
                        </ul>
                        
                    </div>
                    
                    <!-- 영화 정보 -->
                    <div class="movie_info">
                        <!-- 영화관 위치, 관, 시간 등 -->
                         <ul>
                            <li><span class="blur">강동</span></li>
                            <li><span class="blur">3관</span></li>
                            <li><span class="blur">2025.10.04(토)</span></li>
                            <li><span class="time">17:05 ~ 19:33</span><button class="dropdown">∨</button></li>
                        </ul>
                        <div class="movie_detail"></div>
                        <!-- 영화 포스트 -->
                        <div class="movie_img">
                            <img src="img/movieposter.jpg" alt="movieposter">
                        </div>
                    </div>
                    <!-- 영화 좌석 -->
                     <div class="seat_info">
                        <!-- 좌석 상태, 정보 -->
                        <div class="seat_condition">
                            <ul>
                                <li>
                                    <button class="seat_btn"></button>
                                    <span class="blur">선택</span>
                                </li>
                                <li>
                                    <button class="seat_btn"></button>
                                    <span class="blur">예매완료</span>
                                </li>
                                <li><button class="seat_btn"></button>
                                    <span class="blur">선택불가</span>
                                </li>
                                <li><button class="seat_btn"></button>
                                    <span class="blur">일반</span>
                                </li>
                                <li><button class="seat_btn"></button>
                                    <span class="blur">장애인석</span>
                                </li>
                            </ul>
                        </div>
                        <!-- 선택 좌석 표시 -->
                        <div class="seat_select">
                            <span class="blur">선택좌석</span>
                            <div class="seat_array"></div>
                        </div>
                     </div>
                     <!-- 영화 가격 -->
                     <div class="select_result">
                        <ul>
                            <li><span class="select_list">나중에 수정스</span></li>
                            <li class="price"><span class="final">최종결제금액</span><span class="total_price"></span><span>원</span></li>
                        </ul>
                     </div>  
                     <!-- 버튼 -->
                     <div class="btn">
                        <!-- 이전 버튼 -->
                        <button type="button" class="before_btn">이전</button>
                        <button type="button" class="after_btn">이후</button>
                    </div>
                </div>
            </section>
        </main>
        <footer>
            <!-- <img src="/Megabox/img/footer.png"> -->
        </footer>

        <!-- 모달창 -->
        <div class="modal">
            <div class="modal_title">
                <span class="title">알림</span>
                <span class="close_btn">X</span>
            </div>
            <div class="modal_content">
                <p class="content"></p>
                <button class="modal_btn">확인</button>
            </div>
        </div>
        <!-- 오버레이 -->
        <div class="overlay"></div>
    </div>

       <script>
         // 메뉴바 (마우스 오버 -> 보임, 아웃 -> 숨김)
        let menubar=document.querySelectorAll('.menubar'); // 배열
        let menu_hidden=document.querySelectorAll('.menu_hidden');
        let header02_menu=document.querySelector('.header02_menu');

        for(let i=0;i<menubar.length;i++){
            // 마우스오버
            menubar[i].addEventListener('mouseover',()=>{
                // console.log('마우스오버'+menubar[i].textContent);
                // menu_hidden[i].classList.add('active');
                menu_hidden[i].style.display='block';
                header02_menu.style.display='block';
            })
            // 마우스아웃
            menubar[i].addEventListener('mouseout',()=>{
                // menu_hidden[i].classList.remove('active');
                menu_hidden[i].style.display='none';
                header02_menu.style.display='none';
            })
            
        }

        // 모달창
        let close_btn=document.querySelector('.close_btn');
        let overlay=document.querySelector('.overlay');
        let modal=document.querySelector('.modal');
        let modal_btn=document.querySelector('.modal_btn');
        // DOM접근할 때 부모를 타줘야 함!! 
        let content=document.querySelector('.modal .modal_content > .content');

        
        let modal_text=[
            "인원선택은 총 8명까지 가능합니다.",
            "좌석은 1명 이상 선택 가능합니다.",
            "좌석은 선택 인원수만큼 선택 가능합니다.",
            "좌석은 최대 8개까지 선택 가능합니다.",
            "선택하신 좌석을 모두 취소하고 다시 선택하시겠습니까?",

            "◆ 경로 : 만 65세 이상(신분증)"+"</br>"+"</br>"+"경로요금은 만65세 이상 고객에게만 적용되며, 상영관 입장시 본인신분증을 제시해 주시기 바랍니다(*미지참시 입장 제한)"
            +"</br>"+"</br>"+"*경로선택 시 추가 할인이 제한될 수 있습니다",

            "※만 65세이상 고객님께서는 [경로]발권 부탁드립니다(*지점별 상이)"+"</br>"+"</br>"+"◆ 우대요금은 장애인 고객에게 적용되며, 상영관 입장 시 본인확인 증빙서류를 제시해 주시기 바랍니다."
            +"</br>"+"(미지참 시 입장 제한)"+"</br>"+"</br>"+"- 장애인: 복지카드"+"</br>"+"- 국가유공자: 국가유공자증"+"</br>"+"</br>"
            +"위 항목 외 지점별 우대요금 추가적용 대상은 직원확인 후 발권이 가능합니다"+"</br>"+"*우대선택 시 추가 할인이 제한될 수 있습니다."+
            "*국가유공자증에 한하며, 국가유공자 유족증 등은 할인이 불가합니다.",
        ]



        // X누르면 모달창 삭제
        close_btn.addEventListener('click',()=>{
            overlay.style.display='none';
            modal.style.display='none';
        })
        // 확인버튼 누르면 모달창 삭제
        modal_btn.addEventListener('click',()=>{
            overlay.style.display='none';
            modal.style.display='none';
        })


        // 리스트 클릭하면 카테고리 보이고 다시 숨기기 (toggle)
        // DOM 접근
        let list_icon=document.getElementById('list_icon');
        let category=document.querySelector('.category');
        // 클릭 함수
        list_icon.addEventListener('click',()=>{
            category.classList.toggle('active');
        })

         // ---------------------- *** <left> 좌석 테이블 *** -----------------------------------------------------------


        let seat_table=document.querySelector('.seat_table'); // DOM 접근
        // 알파벳배열 만들기
        let abcArray=['A','B','C','D','E','F','G','H',"I",'J'];

        // 2차원배열로 좌석테이블 생성
        // 01. 빈배열생성 (10 X 10)
        let seattable_arr=Array.from(Array(10),()=>new Array(11)); 
        for(let i=0;i<seattable_arr.length;i++){
            for(let j=0;j<seattable_arr[i].length;j++){
            }
        }

        // 03. 테이블만들고 내용 채우기
        // let result='';
        function resetTable(){
            let seatTable='<table border="1">';
        
            for(let i=0;i<seattable_arr.length;i++){
                let num=0;
                seatTable+='<tr class="trr">'+'<td class="abc_row">'+abcArray[i]+'</td>';

                for(let j=0;j<seattable_arr[i].length;j++){
                    seattable_arr[i][j]=num++;
                    seatTable+='<td class="seat_row">'+seattable_arr[i][j]+'</td>';
                    
                }
                seatTable+='</tr>';
                
            }
            seatTable+='</table>';
            seat_table.innerHTML=seatTable;
        }
        resetTable();

        // ---------------------- *** <right> 선택좌석 배열 *** ---------s--------------------------
        let seat_array=document.querySelector('.seat_array');
        
        // 빈배열 생성
        let selectArr=Array.from(Array(4),()=>new Array(2).fill('-'));
        // let selectArr=Array.from(Array(4),()=>new Array(2));

        // for문 돌려서 테이블 생성( 4 X 2 )
        function seat_array02(){
            let seatArray='<table>';
            for(let i=0;i<selectArr.length;i++){
                seatArray+='<tr>';
                    for(let j=0;j<selectArr[i].length;j++){
                        seatArray+='<td class="selectArr02">'+selectArr[i][j]+'</td>';
                    }
                seatArray+='</tr>';
            }
            
            seatArray+='</table>';
            console.log(seatArray);
            seat_array.innerHTML=seatArray;
        }
        seat_array02();

        
        // 좌석 선택시 -> 선택좌석 목록으로 정보 업데이트

        // ---------------가격 -----------------------------------------------------
        let priceInfo=[
            {id:0, type:'성인', price: 13000, quantity:0},
            {id:1, type:'청소년', price: 10000, quantity:0},
            {id:2, type:'경로', price: 7000, quantity:0},
            {id:3, type:'우대', price: 5000, quantity:0},
        ]

        // -------------------*** 초기화 버튼 ***-----------------------------------------
    
        let reset_btn=document.querySelector('#reset_btn');
        let p_num= document.querySelectorAll('.p_num');
        let sumQuantity = 0;
        let total_price = document.querySelector('.total_price');
        let totalPrice = 0;
        

        function reset(){
            // 숫자 초기화
            for(let i=0;i<p_num.length;i++){
                p_num[i].textContent=0;
                priceInfo[i].quantity = 0;
            }
        }
        reset();
        resetTable();

        reset_btn.addEventListener('click',()=>{
            reset();
            resetTable();
        })

        
        // -------------------------(+ , -) 버튼 요소 가져오기---------------------------------------
        let minus = document.querySelectorAll('.minus');
        let plus = document.querySelectorAll('.plus');
        let priceInfoIndex=[]; // priceInfoIndex를 변수로 지정해서 -> (성인인지 청소년인지..) PriceInfo의 인덱스 번호를 저장
        // let seat_num=[]; // + 버튼을 누른 내역을 저장하는 빈 배열 생성 (성인은 몇명을 선택했는지, 청소년은 몇명인지...)
        let index=0; // index=[0,1,2,3,4,5,6,7...]

        // + 버튼 기능 ----------------------------------
        
        for(let i=0;i<plus.length;i++){
        //     console.log(i);
        
        // let indexNum=i;
            
            plus[i].addEventListener('click',function(){
                // let indexNum=0;
                
                
            // function plus(indexNum){
                let p_num= document.querySelectorAll('.p_num');
                console.log('plus'+p_num[i].textContent);
            
                if(p_num[i].textContent>=8){
                    alert('모달창');
                    // 모달창 출력
                }else{
                    p_num[i].textContent++;
                    priceInfo[i].quantity++; // 양
                    // 여기에 좌석테이블에서 클릭시 최종결제금액 증가를 넣으면,
                    // plus버튼을 클릭할때(1번 for문이 돌고)마다 (2번 for문이 누적되어 돌게됨)
                    // if(i === indexNum){
                    priceInfoIndex[index]={
                        id:priceInfo[i].id,
                        type:priceInfo[i].type,
                        quantity:priceInfo[i].quantity,
                        price:priceInfo[i].price,
                    }
                    
                // }
                }
                
            // }
                
                // result+=priceInfoIndex;
                index++;
                console.log(priceInfoIndex);
            })
            
        }

        // 좌석 테이블을 클릭하면 최종결제금액이 증가
        let seat_row=document.querySelectorAll('.seat_row');
        let clickSeat=0;
        let index01=0; // priceInfoIndex의 인덱스
        let index02=0;
        // let trr=document.querySelectorAll('.trr');
        for(let i=0;i<seat_row.length;i++){
            // for(let j=0;j<seattable_arr[i].length;j++){
                seat_row[i].addEventListener('click',()=>{
                clickSeat++;
                if(clickSeat > priceInfoIndex.length){
                    // console.log(`클릭횟수: ${clickSeat}`);
                    alert('모달창');
                }else{
                    seat_row[i].style.backgroundColor='purple';
                    totalPrice+=priceInfoIndex[index01].price; // 가격
                    console.log(`가격: ${priceInfoIndex[index01].price}`);
                    total_price.innerHTML=totalPrice.toLocaleString('ko-kr')+'원';

                    selectArr[index02]=seat_row[i].textContent;
                        console.log(`선택좌석 : ${selectArr}`);
                        seat_array02();
                }
                index01++;
                index02++;
                
            })
            
        }
        
        clickSeat=0;
        
        

        // - 버튼 기능 --------------------------------------
        for(let i=0;i<minus.length;i++){
            minus[i].addEventListener('click',()=>{
                // 좌석선택 전 '- 버튼'을 클릭
                if(clickSeat === 0){
                    console.log(clickSeat);
                    if(p_num[i].textContent<1){
                        // 모달창 출력
                        alert('모달창');
                    }else{
                        p_num[i].textContent--; 
                        priceInfo[i].quantity--; // 양
                        totalPrice-=priceInfo[i].price; // 가격
                        // priceInfo[i].quantity * priceInfo[i].price ( X ) 
                        // 어차피 클릭할 때마다  for문을 돔
                        // 돌 때마다 가격을 누적시키면 해당 [i]의 클릭 수 = 인원 수(양) 
                        // => [i]총 가격을 알 수 있음
                        total_price.innerHTML=totalPrice.toLocaleString('ko-kr')+'원';
                    }
                }
                // 좌석선택 후 '- 버튼'을 클릭 -> 모달창 -> 초기화
                else{
                    alert('선택하신 좌석을 모두 취소하고 다시 선택하시겠습니까?');
                    reset();
                    resetTable();
                }
                
                
                
            })
        }
        reset();


        // 경로, 우대 좌석 +버튼 클릭하면 모달창 ----------------------------
        plus[2].addEventListener('click',()=>{
            let p_num= document.querySelectorAll('.p_num');
            if(p_num[2].textContent==='0'){
                content.innerHTML=modal_text[4]; // 경로 모달창  출력
                overlay.style.display='block';
                modal.style.display='block';
                return;
            }
        })
        plus[3].addEventListener('click',()=>{
            let p_num= document.querySelectorAll('.p_num');
            if(p_num[3].textContent==='0'){
                content.innerHTML=modal_text[5]; // 우대 모달창  출력
                overlay.style.display='block';
                modal.style.display='block';
                return;
            }
        })

        // ---------------------- 좌석 클릭 시 선택 / 해제 기능 ----------------------
        // seatCells = document.querySelectorAll('.basic');
        // for (let i = 0; i < seatCells.length; i++) {
        //     seatCells[i].addEventListener('click', function() {
        //         if (seatCells[i].classList.contains('cantselect')) return;
        //         let row = Math.floor(i / 10);
        //         let col = i % 10;
        //         let seatName = abcArray[row] + (col + 1);
        //         if (seatCells[i].classList.contains('selected')) {
        //             seatCells[i].classList.remove('selected');
        //             removeFromSelectArray(seatName);
        //         } else {
        //             // 선택인원보다 좌석선택 높을 시 모달창
        //             if (getSelectedCount() >= sumQuantity) {
        //                 content.textContent=modal_text[2];
        //                 overlay.style.display='block';
        //                 modal.style.display='block';
        //                 return;
        //             }
        //             seatCells[i].classList.add('selected');
        //             addToSelectArray(seatName);
        //         }
        //         renderSelectTable();
        //     })}


        // -------------------- 관람 인원 선택 목록 우측 업데이트 함수 ------------------------
        // function renderSelectList(){
        //     let selectList = ' ';
        //     for (let i = 0; i < priceInfo.length; i++) {
        //         if (priceInfo[i].quantity > 0) {
        //             selectList += `${priceInfo[i].type} ${priceInfo[i].quantity} · `;
        //         }
        //     }
        //     select_list.innerHTML = selectList.slice(0, -2); // 마지막 · 제거
        // }
        // function getSelectedCount() {
        //     let count = 0;
        //     for (let i = 0; i < selectArray.length; i++) {
        //         let row = selectArray[i];
        //         for (let j = 0; j < row.length; j++) {
        //             if (row[j] !== '-') {
        //                 count++;
        //             }
        //         }
        //     }
        //     return count;
        // }

        // function addToSelectArray(seatName){
        //     for(let i=0;i<selectArray.length;i++){
        //         for(let j=0;j<selectArray[i].length;j++){
        //             if(selectArray[i][j] === '-'){
        //                 selectArray[i][j] = seatName;
        //                 return;
        //             }
        //         }
        //     }
        // }

        // function removeFromSelectArray(seatName){
        //     for(let i=0;i<selectArray.length;i++){
        //         for(let j=0;j<selectArray[i].length;j++){
        //             if(selectArray[i][j] === seatName){
        //                 selectArray[i][j] = '-';
        //                 return;
        //             }
        //         }
        //     }
        // }

        // ------------------------------ 가격 업데이트 -----------------------------
        
        totalPrice = priceInfo.reduce((sum, p)=> sum + (p.price * p.quantity), 0);
        total_price.innerHTML = totalPrice.toLocaleString('ko-kr') + '원';
        

        
    </script>
</body>
</html>